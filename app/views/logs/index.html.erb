<% content_for :page_title, "Results - logs search" %>

<p class="govuk-!-margin-bottom-6">
  <a href="<%= new_logs_search_path %>" class="govuk-back-link">Change search</a>
</p>

<% if logs.present? %>
  <h1 class="govuk-heading-l">Found <%= pluralize(logs.count, "result") %> for "<%= log_search_form.username || log_search_form.ip || location_address %>"</h1>

  <%= render "logs/filtered_results_explanation", logs: %>

  <%= render "logs/filter_logs_select", log_search_form: %>

  <table class="govuk-table">
    <caption class="govuk-table__caption"></caption>
    <thead class="govuk-table__head">
      <tr class="govuk-table__row">
        <th class="govuk-table__header" scope="col">Username</th>
        <th class="govuk-table__header" scope="col">Access Point</th>
        <th class="govuk-table__header" scope="col">MAC Address</th>
        <th class="govuk-table__header" scope="col">IP</th>
        <th class="govuk-table__header" scope="col">Time</th>
        <th class="govuk-table__header" scope="col">Status</th>
        <% if super_admin? %>
          <th class="govuk-table__header" scope="col">Radius Server</th>
        <% end %>
      </tr>
    </thead>
    <tbody class="govuk-table__body">
      <% logs.each do |log| %>
        <tr class="govuk-table__row">
          <td class="govuk-table__cell"><%= log.username %></td>
          <td class="govuk-table__cell"><%= log.ap %></td>
          <td class="govuk-table__cell"><%= log.mac %></td>
          <td class="govuk-table__cell"><%= log.siteIP %></td>
          <td class="govuk-table__cell"><%= log.start %></td>
          <td class="govuk-table__cell"><%= log.success ? "successful" : "failed" %></td>
          <% if super_admin? %>
            <td class="govuk-table__cell"><%= log.task_id %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <div class="govuk-grid-row">
    <h1 class="govuk-heading-l govuk-grid-column-three-quarters">
      <% if log_search_form.filter_option==LogSearchForm::USERNAME_FILTER_OPTION %>
        The username "<%= log_search_form.username %>" <strong>is not reaching the GovWifi service</strong>
      <% elsif log_search_form.filter_option==LogSearchForm::LOCATION_FILTER_OPTION %>
        Traffic from <%= location_address %> <strong>is not reaching the GovWifi service</strong>
      <% else %>
        Traffic from <%= log_search_form.ip %> <strong>is not reaching the GovWifi service</strong>
      <% end %>
    </h1>

    <%= render "logs/filtered_results_explanation", logs: %>

    <%= render "logs/no_logs_explanation" %>
  </div>
<% end %>
